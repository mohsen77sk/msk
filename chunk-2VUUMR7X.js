import{b as ke,c as Ee,d as Me,e as be,f as Ie,g as V,h as Te,i as ut,j as we,k as Fe,l as Re,m as $e,n as Le,o as Be,p as Ve,q as Oe,r as je}from"./chunk-IHQALA6F.js";import{a as Ne}from"./chunk-HSTAYPDS.js";import{c as Ae}from"./chunk-CXAMLLJO.js";import{b as ye,c as dt}from"./chunk-XETUAHZC.js";import{ca as ne,ha as ge}from"./chunk-KVJPCLDQ.js";import{a as xe,b as Ce,c as Se,h as De}from"./chunk-SIUYHYWA.js";import"./chunk-I3ROGWBB.js";import{c as he}from"./chunk-FMTLDRPV.js";import{a as me}from"./chunk-NBWB5455.js";import{a as ce,b as N,c as se,e as le}from"./chunk-XPE6A4UF.js";import{b as Kt,c as J,d as K,e as Yt}from"./chunk-KDKCNII2.js";import{a as E}from"./chunk-K3OUCCZ6.js";import{a as pe,b as it}from"./chunk-I234HARX.js";import{a as fe,b as _e,c as ve,d as pt}from"./chunk-BGJ7BR5O.js";import{A as lt,B as mt,a as Zt,b as te,c as ee,g as ie,h as Z,j as nt,l as M,n as ot,o as at,p as de,r as yt,t as rt,u as ct,w as st,z as ue}from"./chunk-OHW5GPCH.js";import"./chunk-ZVCJ7HI5.js";import"./chunk-QEB7RJPV.js";import{k as et}from"./chunk-OI4AFYXP.js";import"./chunk-GLXDHTOZ.js";import{V as Y,W as X,Z as Xt,da as $,ea as L,fa as oe,ga as ae,ha as re,ia as tt}from"./chunk-EGV4WSDU.js";import"./chunk-TCYW2OPJ.js";import{b as Jt}from"./chunk-LUR2K6FW.js";import{k as Ut,n as H,p as Ht,q as W,s as Wt}from"./chunk-2BJKMOKI.js";import{Aa as z,B as wt,Bc as A,Cb as f,Cc as R,D as Ft,Dc as Dt,Ec as B,F as k,Fa as Nt,Ga as G,Gb as d,Ma as Bt,Mb as g,N as Rt,Nb as Ct,Ob as T,Pb as w,Pc as U,Qb as r,Rb as a,Sb as v,Sc as Qt,Tb as Ot,Ub as jt,Vb as Pt,Wb as q,Z as $t,aa as S,bc as Q,da as Lt,dc as m,g as ht,ib as o,ja as p,k as gt,lc as St,m as bt,mc as zt,n as It,nc as F,oa as x,oc as c,pc as l,qc as h,r as _,tb as Vt,ub as xt,uc as Gt,wc as C,x as Tt,xc as qt,yc as y,za as P}from"./chunk-3NJGGVEI.js";import{a as j,b as Et,c as Mt}from"./chunk-2R6CW7ES.js";var Pe=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=x({type:e,selectors:[["main-accounts"]],standalone:!0,features:[C],decls:1,vars:0,template:function(i,s){i&1&&v(0,"router-outlet")},dependencies:[J],encapsulation:2,changeDetection:0})}}return e})();var ft="code",_t="asc",D=class{constructor(n){this.id=n.id,this.code=n.code,this.accountTypeId=n.accountTypeId,this.accountTypeName=n.accountTypeName,this.createDate=new Date(n.createDate),this.closeDate=n.closeDate?new Date(n.closeDate):void 0,this.balance=n.balance,this.persons=n.persons?.map(t=>new At(t)),this.note=n.note,this.isActive=n.isActive}get fullName(){return this.accountTypeName+" "+this.persons.map(n=>n.name).join("/")}},At=class{constructor(n){this.id=n.id,this.code=n.code,this.name=n.name}};var b=(()=>{class e{constructor(){this._appConfig=p(me),this._httpClient=p(Jt),this._pagination=new ht(null),this._accounts=new ht(null)}get pagination$(){return this._pagination.asObservable()}get _accounts$(){return this._accounts.asObservable()}getAccounts(t=1,i=10,s=`${ft} ${_t}`){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/account/all`,{params:{page:t,pageSize:i,sortBy:s}}).pipe(_(u=>({pagination:new Ee(u),items:u.items.map(I=>new D(I))})),S(u=>{this._pagination.next(u.pagination),this._accounts.next(u.items)}))}getLookupAccounts(){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/account/lookup`).pipe(_(t=>t))}getLookupAccountTypes(){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/accountType/lookup`).pipe(_(t=>t))}getAccount(t){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/account/${t}`).pipe(_(i=>new D(i)))}getBalanceAccount(t){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/account/${t}/balance`).pipe(_(i=>i))}getAccountWithBalance(t){return Tt([this.getAccount(t),this.getBalanceAccount(t)]).pipe(_(i=>new D(j(j({},i[0]),i[1]))))}createAccount(t){return this._httpClient.post(`${this._appConfig.apiEndpoint}/api/account`,t).pipe(_(i=>new D(i)))}updateAccount(t){return this._httpClient.put(`${this._appConfig.apiEndpoint}/api/account`,t).pipe(_(i=>new D(i)),S(i=>{if(this._accounts.value){let s=this._accounts.value.findIndex(u=>u.id===i.id)??0;this._accounts.value[s]=i,this._accounts.next(this._accounts.value)}}))}closeAccount(t){return this._httpClient.post(`${this._appConfig.apiEndpoint}/api/account/close`,t).pipe(_(i=>new D(Et(j({},i),{balance:0}))),S(i=>{if(this._accounts.value){let s=this._accounts.value.findIndex(u=>u.id===i.id)??0;this._accounts.value[s]=i,this._accounts.next(this._accounts.value)}}))}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=Lt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ue=e=>[e];function He(e,n){if(e&1&&(Ot(0),r(1,"mat-icon",1),c(2),a(),jt()),e&2){let t=n.$implicit,i=m();o(),d("ngClass",y(3,Ue,i.value()?"text-green-400":"text-red-400"))("matTooltip",i.value()?t("active"):t("inactive")),o(),h(" ",i.value()?"check_circle":"cancel"," ")}}var Ge=(()=>{class e{constructor(){this.value=Bt(!0,{transform:Qt})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=x({type:e,selectors:[["main-accounts-status"]],inputs:{value:[1,"value"]},standalone:!0,features:[C],decls:1,vars:0,consts:[[4,"transloco"],[1,"text-green-400",3,"ngClass","matTooltip"]],template:function(i,s){i&1&&f(0,He,3,5,"ng-container",0)},dependencies:[H,L,$,it,pe,N],styles:[`main-accounts-status{display:flex}
`],encapsulation:2,changeDetection:0})}}return e})();var Ye=(e,n)=>n.id,Xe=()=>["card","new"],Ze=e=>({"mat-mdc-extended-fab-collapses":e}),ti=e=>["card","view",e];function ei(e,n){if(e&1&&(r(0,"div",11)(1,"form",12)(2,"div",13)(3,"mat-icon"),c(4,"search"),a(),v(5,"input",14),a()()()),e&2){let t=n.$implicit,i=m();o(),d("formGroup",i.filterForm),o(4),d("placeholder",t("accounts.search"))}}function ii(e,n){if(e&1&&(r(0,"div",20)(1,"div",21),c(2),a(),r(3,"div",22)(4,"span"),c(5),a()()()),e&2){let t=m().$implicit;o(2),h(" ",t.fullName," "),o(3),h("#",t.code,"")}}function ni(e,n){if(e&1&&(r(0,"div",4)(1,"div",15),v(2,"msk-avatar",16),a(),f(3,ii,6,2,"div",17),r(4,"div",18),v(5,"main-accounts-status",19),a()()),e&2){let t=n.$implicit;d("routerLink",y(4,ti,t.id)),o(2),d("name",t.persons[0].name),o(),d("translocoRead","accounts.details"),o(2),d("value",t.isActive)}}function oi(e,n){if(e&1&&(r(0,"div",5),c(1),a()),e&2){let t=n.$implicit;o(),h(" ",t("accounts.empty-list")," ")}}function ai(e,n){e&1&&f(0,oi,2,1,"div",23)}function ri(e,n){if(e&1&&(r(0,"span"),c(1),a()),e&2){let t=n.$implicit;o(),l(t("new"))}}var vt=(()=>{class e{constructor(){this._destroyRef=p(G),this._accountService=p(b),this._changeDetectorRef=p(U),this._gridContent=xt.required(et),this._paginator=xt.required(V),this._sort=new be,this.isLoading=!1,this.isFabCollapses=!1,this.lastOffsetScroll=0,this.pageSizeOptions=ke,this.filterForm=new de({search:new yt(""),isActive:new yt(null)})}ngOnInit(){this._accountService.pagination$.pipe(E(this._destroyRef),Ft(t=>!!t)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.accounts$=this._accountService._accounts$}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:ft,start:_t,disableClear:!0}),this._sort.sortChange.pipe(E(this._destroyRef),S(()=>this._paginator().pageIndex=0)).subscribe(),wt(this._sort.sortChange,this._paginator().page).pipe(E(this._destroyRef),$t(()=>this.getAccounts())).subscribe()),this._gridContent().elementScrolled().pipe(E(this._destroyRef),_(t=>t.target.scrollTop||0),S(t=>{let i=t>10?this.lastOffsetScroll<t:!1;this.isFabCollapses!==i&&(this.isFabCollapses=i,this._changeDetectorRef.markForCheck()),this.lastOffsetScroll=t})).subscribe()}getAccounts(t=!1){return this.isLoading=!0,this._changeDetectorRef.markForCheck(),this._accountService.getAccounts(t?1:this._paginator().pageIndex+1,this._paginator().pageSize,`${this._sort.active} ${this._sort.direction}`).pipe(k(i=>bt()),Rt(()=>{this.isLoading=!1,this._changeDetectorRef.markForCheck()}))}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=x({type:e,selectors:[["main-accounts-list"]],viewQuery:function(i,s){i&1&&(St(s._gridContent,et,5),St(s._paginator,V,5)),i&2&&zt(2)},standalone:!0,features:[C],decls:16,vars:15,consts:[[1,"page-layout","grid-scroll"],["class","header",4,"transloco"],[1,"content"],["cdkScrollable","",1,"content-grid"],["matRipple","",1,"content-grid-item","tow-line",3,"routerLink"],[1,"text-secondary","p-8","text-center","text-xl","font-semibold","tracking-tight","sm:p-16"],[1,"content-fab-container"],["mat-fab","","extended","",3,"routerLink","ngClass"],[4,"transloco"],[1,"content-paginator",3,"length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","disabled"],[1,"pointer-events-none","invisible","absolute","h-0","w-0","opacity-0"],[1,"header"],[1,"flex","w-full","items-center",3,"formGroup"],[1,"msk-mat-search-bar","w-full"],["formControlName","search","autocomplete","off",3,"placeholder"],[1,"content-grid-item-avatar"],[3,"name"],["class","content-grid-item-content",4,"transloco","translocoRead"],[1,"content-grid-item-end"],[3,"value"],[1,"content-grid-item-content"],[1,"truncate"],[1,"flex","items-center","gap-2","truncate"],["class","text-secondary p-8 text-center text-xl font-semibold tracking-tight sm:p-16",4,"transloco"]],template:function(i,s){i&1&&(r(0,"div",0),f(1,ei,6,2,"div",1),r(2,"div",2)(3,"div",3),T(4,ni,6,6,"div",4,Ye,!1,ai,1,0,"div",5),A(7,"async"),a(),r(8,"div",6)(9,"button",7)(10,"mat-icon"),c(11,"add"),a(),f(12,ri,2,1,"span",8),a()(),v(13,"mat-paginator",9),a()(),r(14,"div",10),v(15,"router-outlet"),a()),i&2&&(o(4),w(R(7,10,s.accounts$)),o(5),d("routerLink",qt(12,Xe))("ngClass",y(13,Ze,s.isFabCollapses))("@zoomIn",void 0),o(4),d("length",s.pagination.total)("pageIndex",s.pagination.pageIndex)("pageSize",s.pagination.pageSize)("pageSizeOptions",s.pageSizeOptions)("showFirstLastButtons",!0)("disabled",s.isLoading))},dependencies:[W,H,lt,rt,nt,ot,at,mt,ct,st,Yt,J,et,L,$,ge,dt,X,Y,tt,ae,Z,Ie,Te,V,N,ut,Ge],encapsulation:2,data:{animation:pt},changeDetection:0})}}return e})();var ci=(e,n)=>n.id,si=e=>({code:e}),li=e=>({t:e});function mi(e,n){if(e&1){let t=q();r(0,"button",9),Q("click",function(){P(t);let s=m(3);return z(s.editMode())}),r(1,"mat-icon",10),c(2,"edit"),a()()}}function pi(e,n){if(e&1&&f(0,mi,3,0,"button",8),e&2){let t=m(2);g(t.data.item!=null&&t.data.item.isActive?0:-1)}}function di(e,n){if(e&1&&(r(0,"span"),c(1),a()),e&2){let t=n.$implicit,i=m(3);o(),l(i.form.enabled?t("save"):"")}}function ui(e,n){if(e&1){let t=q();r(0,"button",11),Q("click",function(){P(t);let s=m(2);return z(s.saveAndClose())}),f(1,di,2,1,"span",12),a()}if(e&2){let t=m(2);d("disabled",t.form.disabled)("mskSpinner",t.form.disabled)}}function fi(e,n){if(e&1&&(r(0,"msk-dialog",6),Pt(1,7),f(2,pi,1,1,"ng-template",null,2,B)(4,ui,2,2,"ng-template",null,3,B),a()),e&2){let t=n.$implicit,i=F(3),s=F(5),u=m(),I=F(2),Qe=F(4);d("title",t(u.data.action,y(6,si,u.data.item==null?null:u.data.item.code)))("hasAction",u.data.action!=="view")("primaryAction",s)("trailing",i),o(),d("ngTemplateOutlet",u.data.action==="view"?I:Qe)("ngTemplateOutletContext",y(8,li,t))}}function _i(e,n){if(e&1&&(r(0,"div",16)(1,"button",22)(2,"mat-icon",23),c(3,"arrow_upward"),a(),c(4),a(),r(5,"button",24)(6,"mat-icon",23),c(7,"arrow_downward"),a(),c(8),a(),r(9,"button",24)(10,"mat-icon",23),c(11,"swap_horiz"),a(),c(12),a()()),e&2){let t=n.$implicit;o(4),h(" ",t("deposit")," "),o(4),h(" ",t("withdraw")," "),o(4),h(" ",t("transfer")," ")}}function vi(e,n){e&1&&f(0,_i,13,3,"div",21)}function hi(e,n){if(e&1&&(r(0,"div",19)(1,"div",25),v(2,"msk-avatar",26),a(),r(3,"div",27)(4,"span"),c(5),a(),r(6,"span"),c(7),a()(),r(8,"div",25)(9,"mat-icon",28),c(10,"open_in_new"),a()()()),e&2){let t=n.$implicit;o(2),d("name",t.name),o(3),l(t.name),o(2),h("#",t.code,"")}}function gi(e,n){if(e&1&&(r(0,"div",20)(1,"div",25)(2,"mat-icon"),c(3,"credit_card_gear"),a()(),r(4,"div",27)(5,"span"),c(6),a(),r(7,"span"),c(8),a()()()),e&2){let t=m().t,i=m();o(6),l(i.data.item==null?null:i.data.item.accountTypeName),o(2),l(t("accountType"))}}function xi(e,n){if(e&1&&(r(0,"div",20)(1,"div",25)(2,"mat-icon"),c(3,"calendar_add_on"),a()(),r(4,"div",27)(5,"span"),c(6),A(7,"mskDateTime"),a(),r(8,"span"),c(9),a()()()),e&2){let t=m().t,i=m();o(6),l(Dt(7,2,i.data.item==null?null:i.data.item.createDate,"longDate")||"-"),o(3),l(t("createDate"))}}function Ci(e,n){if(e&1&&(r(0,"div",20)(1,"div",25)(2,"mat-icon"),c(3,"event_busy"),a()(),r(4,"div",27)(5,"span"),c(6),A(7,"mskDateTime"),a(),r(8,"span"),c(9),a()()()),e&2){let t=m().t,i=m();o(6),l(Dt(7,2,i.data.item==null?null:i.data.item.closeDate,"longDate")||"-"),o(3),l(t("closeDate"))}}function Si(e,n){if(e&1&&(r(0,"div",17)(1,"div",18),c(2),a(),r(3,"div",20)(4,"div",25)(5,"mat-icon"),c(6,"sticky_note_2"),a()(),r(7,"div",27)(8,"span"),c(9),a()()()()),e&2){let t=m().t,i=m();o(2),l(t("note")),o(7),l(i.data.item==null?null:i.data.item.note)}}function Di(e,n){if(e&1){let t=q();r(0,"div",31)(1,"div",18),c(2),a(),r(3,"div",32),Q("click",function(){P(t);let s=m(3);return z(s.updateStatus())}),r(4,"div",25)(5,"mat-icon",33),c(6," cancel "),a()(),r(7,"div",27)(8,"span",33),c(9),a()()()()}if(e&2){let t=n.$implicit;o(2),l(t("settings")),o(7),h(" ",t("accounts.deactivate")," ")}}function yi(e,n){e&1&&(v(0,"div",29),f(1,Di,10,2,"div",30))}function Ai(e,n){if(e&1&&(r(0,"div",13)(1,"span",14),c(2),a(),r(3,"span",15),c(4),A(5,"currency"),a()(),f(6,vi,1,0,"div",16),r(7,"div",17)(8,"div",18),c(9),a(),T(10,hi,11,3,"div",19,ci),a(),r(12,"div",17)(13,"div",18),c(14),a(),f(15,gi,9,2,"div",20)(16,xi,10,5,"div",20)(17,Ci,10,5,"div",20),a(),f(18,Si,10,2,"div",17)(19,yi,2,0)),e&2){let t=n.t,i=m();o(2),l(t("credit")),o(2),l(R(5,10,i.data.item==null?null:i.data.item.balance)),o(2),g(i.data.item!=null&&i.data.item.isActive?6:-1),o(3),l(t("owners")),o(),w(i.data.item==null?null:i.data.item.persons),o(4),l(t("about")),o(),g(i.data.item!=null&&i.data.item.accountTypeName?15:-1),o(),g(i.data.item!=null&&i.data.item.createDate?16:-1),o(),g(i.data.item!=null&&i.data.item.closeDate?17:-1),o(),g(i.data.item!=null&&i.data.item.note?18:-1),o(),g(i.data.item!=null&&i.data.item.isActive?19:-1)}}function ki(e,n){if(e&1&&(r(0,"msk-alert",35)(1,"span",42),c(2),a(),c(3),a()),e&2){let t=n.$implicit;o(2),l(t("info-edit-title")),o(),h(" ",t("info-edit-description")," ")}}function Ei(e,n){e&1&&f(0,ki,4,2,"msk-alert",41),e&2&&d("translocoRead","accounts")}function Mi(e,n){if(e&1&&(r(0,"msk-alert",36),c(1),a()),e&2){let t=m(2);d("@shake",void 0),o(),h(" ",t.alert().message," ")}}function bi(e,n){if(e&1&&(r(0,"mat-option",39),c(1),a()),e&2){let t=n.$implicit;d("value",t.id),o(),l(t.name)}}function Ii(e,n){if(e&1&&(r(0,"div",37)(1,"mat-form-field")(2,"mat-label"),c(3),a(),r(4,"mat-select",43),T(5,bi,2,2,"mat-option",39,Ct),A(7,"async"),a(),r(8,"mat-error"),c(9),a()(),r(10,"mat-form-field")(11,"mat-label"),c(12),a(),v(13,"input",44)(14,"mat-datepicker-toggle",45)(15,"mat-datepicker",null,4),r(17,"mat-error"),c(18),a()()()),e&2){let t=F(16),i=m().t,s=m();o(3),l(i("accountType")),o(2),w(R(7,6,s.accountTypeList$)),o(4),l(s.formErrors.accountTypeId),o(3),l(i("createDate")),o(),d("matDatepicker",t),o(),d("for",t),o(4),l(s.formErrors.createDate)}}function Ti(e,n){if(e&1&&(r(0,"mat-option",39),c(1),a()),e&2){let t=n.$implicit;d("value",t.id),o(),l(t.name)}}function wi(e,n){if(e&1&&(r(0,"mat-form-field")(1,"mat-label"),c(2),a(),v(3,"input",46),r(4,"mat-error"),c(5),a()()),e&2){let t=m().t,i=m();o(2),l(t("initCredit")),o(3),l(i.formErrors.initCredit)}}function Fi(e,n){if(e&1&&(r(0,"form",34),f(1,Ei,1,1,"msk-alert",35)(2,Mi,2,2,"msk-alert",36)(3,Ii,19,8,"div",37),r(4,"mat-form-field")(5,"mat-label"),c(6),a(),r(7,"mat-select",38),Gt(8),A(9,"async"),r(10,"mat-select-trigger"),c(11),a(),T(12,Ti,2,2,"mat-option",39,Ct),a(),r(14,"mat-error"),c(15),a()(),f(16,wi,6,2,"mat-form-field"),r(17,"mat-form-field"),v(18,"textarea",40),r(19,"mat-error"),c(20),a()()()),e&2){let t=n.t,i=m();d("formGroup",i.form),o(),g(i.data.action==="edit"?1:-1),o(),g(i.alert().show?2:-1),o(),g(i.data.action==="new"?3:-1),o(3),l(t("owners"));let s=R(9,11,i.personList$);o(5),l(i.personIdTitles(s)),o(),w(s),o(3),l(i.formErrors.personId),o(),g(i.data.action==="new"?16:-1),o(2),d("placeholder",t("note"))("rows",2),o(2),l(i.formErrors.note)}}var qe=(()=>{class e{constructor(){this.data=p(Ce),this.dialogRef=p(xe),this._formBuilder=p(ue),this._peopleService=p(Me),this._accountService=p(b),this._translocoService=p(ce),this._changeDetectorRef=p(U),this._mskConfirmationService=p(Ne),this.formErrors={},this.personList$=this._peopleService.getLookupPersons(),this.accountTypeList$=this._accountService.getLookupAccountTypes(),this.alert=Vt({show:!1,message:""})}ngOnInit(){this.form=this._formBuilder.group({id:[0,M.required],personId:[[],M.required],accountTypeId:["",M.required],initCredit:["",[M.required,M.min(1e3)]],createDate:[new Date(new Date().setHours(0,0,0,0)),M.required],note:""}),new Ve(this.form,this.formErrors,this._translocoService),this.form.patchValue(this.data.item||{}),this.form.get("personId")?.patchValue(this.data.item?.persons.map(t=>t.id)||[])}personIdTitles(t){let i=this.form.get("personId")?.value;return t?.find(u=>u.id===i[0])?.name+(i.length>1?` (+${i.length-1} ${this._translocoService.translate("other")})`:"")}editMode(){this.data.action="edit",this.form.get("initCredit")?.clearValidators()}updateStatus(){let t=this.data.item?.isActive;this._mskConfirmationService.open({title:this._translocoService.translate(t?"accounts.deactivate":"accounts.activate"),message:this._translocoService.translate(t?"accounts.deactivate-message":"accounts.activate-message",{name:this.data.item?.fullName}),actions:{confirm:{label:this._translocoService.translate(t?"close":"open")},cancel:{label:this._translocoService.translate("cancel")}}}).afterClosed().subscribe(s=>{if(s!=="confirmed")return;let u={id:this.data.item?.id,closeDate:new Date(new Date().setSeconds(0,0))};this._accountService.closeAccount(u).pipe(_(I=>{this.data.item=I,this._changeDetectorRef.markForCheck()}),k(I=>gt)).subscribe()})}saveAndClose(){if(je(this.form),this.form.invalid)return;this.form.disable(),this.alert.set({show:!1,message:""}),(this.data.action==="edit"?this._accountService.updateAccount({id:this.form.value.id,personId:this.form.value.personId,note:this.form.value.note}):this._accountService.createAccount(this.form.value)).pipe(S(i=>this.dialogRef.close(i)),k(i=>(this.form.enable(),this.alert.set({show:!0,message:i.error.message}),Oe(i.error.errors,this.form),gt))).subscribe()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=x({type:e,selectors:[["main-people-details"]],standalone:!0,features:[C],decls:5,vars:1,consts:[["viewTemplate",""],["formTemplate",""],["trailing",""],["primaryAction",""],["picker",""],[3,"title","hasAction","primaryAction","trailing",4,"transloco","translocoRead"],[3,"title","hasAction","primaryAction","trailing"],["msk-dialog-content","",3,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-icon-button",""],["mat-icon-button","",3,"click"],[1,"mat-icon-rtl-mirror","text-current"],["mat-button","",3,"click","disabled","mskSpinner"],[4,"transloco"],[1,"flex","flex-col","gap-4","p-4"],[1,"text-on-surface-variant","text-label-medium"],[1,"text-on-surface","text-title-large"],[1,"grid","grid-cols-3","gap-4","py-4"],[1,"msk-mat-card-filled","mb-2","p-4"],[1,"text-secondary","mb-2","font-bold"],["matRipple","",1,"msk-list-item","-mx-4","cursor-pointer"],[1,"msk-list-item","-mx-4"],["class","grid grid-cols-3 gap-4 py-4",4,"transloco"],["mat-flat-button",""],[1,"hidden","sm:block"],["mat-stroked-button",""],[1,"msk-list-item-icon"],[3,"name"],[1,"msk-list-item-content"],[1,"mat-icon-rtl-mirror"],[1,"my-4","border-t"],["class","mb-2",4,"transloco"],[1,"mb-2"],["matRipple","",1,"msk-list-item","-mx-6","cursor-pointer","gap-2",3,"click"],[1,"!text-error"],[1,"flex","flex-auto","flex-col","gap-y-2",3,"formGroup"],["appearance","outline","type","info","dismissible","",1,"mb-4"],["appearance","outline","type","error",1,"mb-4"],[1,"flex","flex-col","gap-x-4","sm:flex-row","[&>*]:flex-1"],["formControlName","personId","multiple",""],[3,"value"],["matInput","","formControlName","note",3,"placeholder","rows"],["class","mb-4","appearance","outline","type","info","dismissible","",4,"transloco","translocoRead"],["mskAlertTitle",""],["formControlName","accountTypeId"],["matInput","","formControlName","createDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["matInput","","formControlName","initCredit","autocomplete","off"]],template:function(i,s){i&1&&f(0,fi,6,10,"msk-dialog",5)(1,Ai,20,12,"ng-template",null,0,B)(3,Fi,21,13,"ng-template",null,1,B),i&2&&d("translocoRead","accounts.details")},dependencies:[Ht,W,Wt,lt,rt,nt,ot,at,mt,ct,st,L,$,dt,ye,ie,Zt,te,ee,X,Y,tt,oe,re,ve,fe,_e,Xt,it,Z,$e,we,Fe,Re,De,N,he,ut,Le,Ae,Be],encapsulation:2,data:{animation:pt},changeDetection:0})}}return e})();var kt=(()=>{class e{constructor(){this._router=p(K),this._injector=p(Nt),this._matDialog=p(Se),this._destroyRef=p(G),this._activatedRoute=p(Kt),this._mskLayoutConfigService=p(ne)}ngOnInit(){let t=this._activatedRoute.snapshot.url[1].path;this._mskLayoutConfigService.config$.pipe(E(this._destroyRef),_(i=>this.layoutDirection=Ut(i.locale))).subscribe(),this._matDialog.open(qe,{autoFocus:t!=="view",disableClose:t!=="view",direction:this.layoutDirection,data:{action:t,item:this._activatedRoute.snapshot.data.card}}).afterClosed().subscribe(i=>{t==="new"&&i!="cancelled"&&this._injector.get(vt).getAccounts().subscribe(),this._router.navigate([this._activatedRoute.snapshot.url.map(()=>"../").join("")],{relativeTo:this._activatedRoute})})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=x({type:e,selectors:[["main-accounts-card"]],standalone:!0,features:[C],decls:0,vars:0,template:function(i,s){},encapsulation:2,changeDetection:0})}}return e})();var Ri=Mt({"./i18n/en.json":()=>import("./chunk-V4WTMKZN.js"),"./i18n/fa.json":()=>import("./chunk-HTZE5BF4.js")});var $i=(e,n)=>{let t=p(b),i=p(K);return t.getAccountWithBalance(e.paramMap.get("id")??0).pipe(k(s=>{console.error(s);let u=n.url.split("/").slice(0,-1).join("/");return i.navigateByUrl(u),It(()=>new Error(s.message))}))},Lo=[{path:"",component:Pe,providers:[se({scope:"accounts",loader:le((e,n)=>Ri(`./${n}/${e}.json`))})],children:[{path:"",component:vt,resolve:{persons:()=>p(b).getAccounts()},children:[{path:"card/new",component:kt,resolve:{}},{path:"card/view/:id",component:kt,resolve:{card:$i}}]}]}];export{Pe as AccountsComponent,Lo as routes};
