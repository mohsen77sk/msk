import{a as _}from"./chunk-BJBINJGA.js";import{b as Le}from"./chunk-2C77R4OO.js";import{Aa as se,Ab as de,E as Q,I as X,Ia as re,Jb as he,Nb as fe,Oc as pe,Qc as ve,R as ee,Rc as N,U as te,X as y,Zb as ge,_ as ne,ba as p,ea as g,f as W,fb as ae,g as Y,ga as v,ha as h,j as U,k as E,ka as m,l as M,lb as x,nb as oe,ob as C,p as Z,q as T,qb as le,r as q,ra as ie,w as R,xb as ce,zb as ue}from"./chunk-RXWBIK5J.js";import{a as d,b as O,d as J}from"./chunk-FIRXXYNY.js";var V=class{translations;constructor(r){this.translations=r}getTranslation(r){return M(this.translations.get(r)||{})}},ye=new g("TRANSLOCO_LOADER");function k(n,r){return n&&(Object.prototype.hasOwnProperty.call(n,r)?n[r]:r.split(".").reduce((e,t)=>e?.[t],n))}function _e(n,r,e){n=d({},n);let t=r.split("."),i=t.length-1;return t.reduce((s,a,o)=>(o===i?s[a]=e:s[a]=Array.isArray(s[a])?s[a].slice():d({},s[a]),s&&s[a]),n),n}function be(n){return n?Array.isArray(n)?n.length:I(n)?Object.keys(n).length:n?n.length:0:0}function ke(n){return be(n)===0}function Pe(n){return typeof n=="function"}function S(n){return typeof n=="string"}function I(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function Se(n){return n.replace(/(?:^\w|[A-Z]|\b\w)/g,(r,e)=>e==0?r.toLowerCase():r.toUpperCase()).replace(/\s+|_|-|\//g,"")}function H(n){return n==null}function me(n){return H(n)===!1}function Ae(n){return n&&typeof n.scope=="string"}function Ve(n){return n&&I(n.loader)}function Te(n){let r={};function e(t,i){if(t===null)r[i]=null;else if(I(t))for(let[s,a]of Object.entries(t))e(a,i?`${i}.${s}`:s);else r[i]=t}return e(n,""),r}function He(n){let r={};for(let[e,t]of Object.entries(n)){let i=e.split("."),s=r;i.forEach((a,o)=>{o===i.length-1?s[a]=t:(s[a]??={},s=s[a])})}return r}var A=new g("TRANSLOCO_CONFIG",{providedIn:"root",factory:()=>b}),b={defaultLang:"en",reRenderOnLangChange:!1,prodMode:!1,failedRetries:2,fallbackLang:[],availableLangs:[],missingHandler:{logMissingKey:!0,useFallbackTranslation:!1,allowEmpty:!1},flatten:{aot:!1},interpolation:["{{","}}"],scopes:{keepCasing:!1}};function Ke(n={}){return O(d(d({},b),n),{missingHandler:d(d({},b.missingHandler),n.missingHandler),flatten:d(d({},b.flatten),n.flatten),scopes:d(d({},b.scopes),n.scopes)})}var Oe=new g("TRANSLOCO_TRANSPILER"),ze=(()=>{class n{config=h(A,{optional:!0})??b;get interpolationMatcher(){return Be(this.config)}transpile({value:e,params:t={},translation:i,key:s}){if(S(e)){let a,o=e;for(;(a=this.interpolationMatcher.exec(o))!==null;){let[c,l]=a;o=o.replace(c,()=>{let u=l.trim(),f=k(t,u);return me(f)?f:me(i[u])?this.transpile({params:t,translation:i,key:s,value:i[u]}):""})}return o}else t&&(I(e)?e=this.handleObject({value:e,params:t,translation:i,key:s}):Array.isArray(e)&&(e=this.handleArray({value:e,params:t,translation:i,key:s})));return e}handleObject({value:e,params:t={},translation:i,key:s}){let a=e;return Object.keys(t).forEach(o=>{let c=this.transpile({value:k(a,o),params:k(t,o),translation:i,key:s});a=_e(a,o,c)}),a}handleArray(i){var s=i,{value:e}=s,t=J(s,["value"]);return e.map(a=>this.transpile(d({value:a},t)))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=p({token:n,factory:n.\u0275fac})}return n})();function Be(n){let[r,e]=n.interpolation;return new RegExp(`${r}([^${r}${e}]*?)${e}`,"g")}var Ce=new g("TRANSLOCO_MISSING_HANDLER"),Ge=(()=>{class n{handle(e,t){if(t.missingHandler.logMissingKey&&!t.prodMode){let i=`Missing translation for '${e}'`;console.warn(`%c ${i}`,"font-size: 12px; color: red")}return e}static \u0275fac=function(t){return new(t||n)};static \u0275prov=p({token:n,factory:n.\u0275fac})}return n})(),we=new g("TRANSLOCO_INTERCEPTOR"),Je=(()=>{class n{preSaveTranslation(e){return e}preSaveTranslationKey(e,t){return t}static \u0275fac=function(t){return new(t||n)};static \u0275prov=p({token:n,factory:n.\u0275fac})}return n})(),Me=new g("TRANSLOCO_FALLBACK_STRATEGY"),We=(()=>{class n{userConfig;constructor(e){this.userConfig=e}getNextLangs(){let e=this.userConfig.fallbackLang;if(!e)throw new Error("When using the default fallback, a fallback language must be provided in the config!");return Array.isArray(e)?e:[e]}static \u0275fac=function(t){return new(t||n)(v(A))};static \u0275prov=p({token:n,factory:n.\u0275fac})}return n})();function w(n){if(!n)return"";let r=n.split("/");return r.pop(),r.join("/")}function L(n){return n?n.split("/").pop():""}function K(n,r,e="|"){if(S(n)){let t=n.split(e),i=t.pop();return i===r?[!0,t.toString()]:[!1,i]}return[!1,""]}function Re(n,r){let[e]=K(r,"static");return e?!1:!!n.config.reRenderOnLangChange}function Ne(n){return n?r=>r:X(1)}function Ye(n,r){return Object.keys(n).reduce((e,t)=>(e[`${r}/${t}`]=n[t],e),{})}function B(n,r){return Ve(n)?Ye(n.loader,r):void 0}function P(n){return{scope:w(n)||null,langName:L(n)}}function je(n){let{path:r,inlineLoader:e,mainLoader:t,data:i}=n;if(e){let s=e[r];if(Pe(s)===!1)throw`You're using an inline loader but didn't provide a loader for ${r}`;return e[r]().then(a=>a.default?a.default:a)}return t.getTranslation(r,i)}function Ue({mainLoader:n,path:r,data:e,fallbackPath:t,inlineLoader:i}){return(t?[r,t]:[r]).map(a=>{let o=je({path:a,mainLoader:n,inlineLoader:i,data:e});return E(o).pipe(T(c=>({translation:c,lang:a})))})}var Ze;var $=(()=>{class n{loader;parser;missingHandler;interceptor;fallbackStrategy;langChanges$;translations=new Map;cache=new Map;firstFallbackLang;defaultLang="";availableLangs=[];isResolvedMissingOnce=!1;lang;failedLangs=new Set;events=new W;events$=this.events.asObservable();config;constructor(e,t,i,s,a,o){this.loader=e,this.parser=t,this.missingHandler=i,this.interceptor=s,this.fallbackStrategy=o,this.loader||(this.loader=new V(this.translations)),Ze=this,this.config=JSON.parse(JSON.stringify(a)),this.setAvailableLangs(this.config.availableLangs||[]),this.setFallbackLangForMissingTranslation(this.config),this.setDefaultLang(this.config.defaultLang),this.lang=new Y(this.getDefaultLang()),this.langChanges$=this.lang.asObservable(),this.events$.pipe(_()).subscribe(c=>{c.type==="translationLoadSuccess"&&c.wasFailure&&this.setActiveLang(c.payload.langName)})}getDefaultLang(){return this.defaultLang}setDefaultLang(e){this.defaultLang=e}getActiveLang(){return this.lang.getValue()}setActiveLang(e){return this.parser.onLangChanged?.(e),this.lang.next(e),this.events.next({type:"langChanged",payload:P(e)}),this}setAvailableLangs(e){this.availableLangs=e}getAvailableLangs(){return this.availableLangs}load(e,t={}){let i=this.cache.get(e);if(i)return i;let s,a=this._isLangScoped(e),o;a&&(o=w(e));let c={path:e,mainLoader:this.loader,inlineLoader:t.inlineLoader,data:a?{scope:o}:void 0};if(this.useFallbackTranslation(e)){let u=a?`${o}/${this.firstFallbackLang}`:this.firstFallbackLang,f=Ue(O(d({},c),{fallbackPath:u}));s=R(f)}else{let u=je(c);s=E(u)}let l=s.pipe(ee(this.config.failedRetries),ne(u=>{if(Array.isArray(u)){u.forEach(f=>{this.handleSuccess(f.lang,f.translation),f.lang!==e&&this.cache.set(f.lang,M({}))});return}this.handleSuccess(e,u)}),Q(u=>(this.config.prodMode||console.error(`Error while trying to load "${e}"`,u),this.handleFailure(e,t))),te(1));return this.cache.set(e,l),l}translate(e,t={},i=this.getActiveLang()){if(!e)return e;let{scope:s,resolveLang:a}=this.resolveLangAndScope(i);if(Array.isArray(e))return e.map(l=>this.translate(s?`${s}.${l}`:l,t,a));e=s?`${s}.${e}`:e;let o=this.getTranslation(a),c=o[e];return c?this.parser.transpile({value:c,params:t,translation:o,key:e}):this._handleMissingKey(e,c,t)}selectTranslate(e,t,i,s=!1){let a,o=(l,u)=>this.load(l,u).pipe(T(()=>s?this.translateObject(e,t,l):this.translate(e,t,l)));if(H(i))return this.langChanges$.pipe(y(l=>o(l)));if(i=Array.isArray(i)?i[0]:i,Ae(i)){let l=i;i=l.scope,a=B(l,l.scope)}if(i=i,this.isLang(i)||this.isScopeWithLang(i))return o(i);let c=i;return this.langChanges$.pipe(y(l=>o(`${c}/${l}`,{inlineLoader:a})))}isScopeWithLang(e){return this.isLang(L(e))}translateObject(e,t={},i=this.getActiveLang()){if(S(e)||Array.isArray(e)){let{resolveLang:a,scope:o}=this.resolveLangAndScope(i);if(Array.isArray(e))return e.map(u=>this.translateObject(o?`${o}.${u}`:u,t,a));let c=this.getTranslation(a);e=o?`${o}.${e}`:e;let l=He(this.getObjectByKey(c,e));return ke(l)?this.translate(e,t,i):this.parser.transpile({value:l,params:t,translation:c,key:e})}let s=[];for(let[a,o]of this.getEntries(e))s.push(this.translateObject(a,o,i));return s}selectTranslateObject(e,t,i){if(S(e)||Array.isArray(e))return this.selectTranslate(e,t,i,!0);let[[s,a],...o]=this.getEntries(e);return this.selectTranslateObject(s,a,i).pipe(T(c=>{let l=[c];for(let[u,f]of o)l.push(this.translateObject(u,f,i));return l}))}getTranslation(e){if(e){if(this.isLang(e))return this.translations.get(e)||{};{let{scope:t,resolveLang:i}=this.resolveLangAndScope(e),s=this.translations.get(i)||{};return this.getObjectByKey(s,t)}}return this.translations}selectTranslation(e){let t=this.langChanges$;if(e){let i=L(e)!==e;this.isLang(e)||i?t=M(e):t=this.langChanges$.pipe(T(s=>`${e}/${s}`))}return t.pipe(y(i=>this.load(i).pipe(T(()=>this.getTranslation(i)))))}setTranslation(e,t=this.getActiveLang(),i={}){let a=d(d({},{merge:!0,emitChange:!0}),i),o=w(t),c=e;if(o){let Ee=this.getMappedScope(o);c=Te({[Ee]:e})}let l=o?L(t):t,u=d(d({},a.merge&&this.getTranslation(l)),c),f=this.config.flatten.aot?u:Te(u),De=this.interceptor.preSaveTranslation(f,l);this.translations.set(l,De),a.emitChange&&this.setActiveLang(this.getActiveLang())}setTranslationKey(e,t,i={}){let s=i.lang||this.getActiveLang(),a=this.interceptor.preSaveTranslationKey(e,t,s),o={[e]:a};this.setTranslation(o,s,O(d({},i),{merge:!0}))}setFallbackLangForMissingTranslation({fallbackLang:e}){let t=Array.isArray(e)?e[0]:e;e&&this.useFallbackTranslation(t)&&(this.firstFallbackLang=t)}_handleMissingKey(e,t,i){if(this.config.missingHandler.allowEmpty&&t==="")return"";if(!this.isResolvedMissingOnce&&this.useFallbackTranslation()){this.isResolvedMissingOnce=!0;let s=this.translate(e,i,this.firstFallbackLang);return this.isResolvedMissingOnce=!1,s}return this.missingHandler.handle(e,this.getMissingHandlerData(),i)}_isLangScoped(e){return this.getAvailableLangsIds().indexOf(e)===-1}isLang(e){return this.getAvailableLangsIds().indexOf(e)!==-1}_loadDependencies(e,t){let i=L(e);return this._isLangScoped(e)&&!this.isLoadedTranslation(i)?q([this.load(i),this.load(e,{inlineLoader:t})]):this.load(e,{inlineLoader:t})}_completeScopeWithLang(e){return this._isLangScoped(e)&&!this.isLang(L(e))?`${e}/${this.getActiveLang()}`:e}_setScopeAlias(e,t){this.config.scopeMapping||(this.config.scopeMapping={}),this.config.scopeMapping[e]=t}ngOnDestroy(){this.cache.clear()}isLoadedTranslation(e){return be(this.getTranslation(e))}getAvailableLangsIds(){let e=this.getAvailableLangs()[0];return S(e)?this.getAvailableLangs():this.getAvailableLangs().map(t=>t.id)}getMissingHandlerData(){return O(d({},this.config),{activeLang:this.getActiveLang(),availableLangs:this.availableLangs,defaultLang:this.defaultLang})}useFallbackTranslation(e){return this.config.missingHandler.useFallbackTranslation&&e!==this.firstFallbackLang}handleSuccess(e,t){this.setTranslation(t,e,{emitChange:!1}),this.events.next({wasFailure:!!this.failedLangs.size,type:"translationLoadSuccess",payload:P(e)}),this.failedLangs.forEach(i=>this.cache.delete(i)),this.failedLangs.clear()}handleFailure(e,t){H(t.failedCounter)&&(t.failedCounter=0,t.fallbackLangs||(t.fallbackLangs=this.fallbackStrategy.getNextLangs(e)));let i=e.split("/"),a=t.fallbackLangs[t.failedCounter];if(this.failedLangs.add(e),this.cache.has(a))return this.handleSuccess(a,this.getTranslation(a)),U;let o=a===i[i.length-1];if(!a||o){let l="Unable to load translation and all the fallback languages";throw i.length>1&&(l+=", did you misspelled the scope name?"),new Error(l)}let c=a;return i.length>1&&(i[i.length-1]=a,c=i.join("/")),t.failedCounter++,this.events.next({type:"translationLoadFailure",payload:P(e)}),this.load(c,t)}getMappedScope(e){let{scopeMapping:t={},scopes:i={keepCasing:!1}}=this.config;return t[e]||(i.keepCasing?e:Se(e))}resolveLangAndScope(e){let t=e,i;if(this._isLangScoped(e)){let s=L(e),a=this.isLang(s);t=a?s:this.getActiveLang(),i=this.getMappedScope(a?w(e):e)}return{scope:i,resolveLang:t}}getObjectByKey(e,t){let i={},s=`${t}.`;for(let a in e)a.startsWith(s)&&(i[a.replace(s,"")]=e[a]);return i}getEntries(e){return e instanceof Map?e.entries():Object.entries(e)}static \u0275fac=function(t){return new(t||n)(v(ye,8),v(Oe),v(Ce),v(we),v(A),v(Me))};static \u0275prov=p({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),qe=(()=>{class n{html;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ce({type:n,selectors:[["ng-component"]],inputs:{html:"html"},decls:1,vars:1,consts:[[1,"transloco-loader-template",3,"innerHTML"]],template:function(t,i){t&1&&ge(0,"div",0),t&2&&fe("innerHTML",i.html,ae)},encapsulation:2})}return n})(),z=class{view;vcr;constructor(r,e){this.view=r,this.vcr=e}attachView(){if(this.view instanceof x)this.vcr.createEmbeddedView(this.view);else if(S(this.view)){let r=this.vcr.createComponent(qe);r.instance.html=this.view,r.hostView.detectChanges()}else this.vcr.createComponent(this.view)}detachView(){this.vcr.clear()}},Fe=new g("TRANSLOCO_LANG"),Qe=new g("TRANSLOCO_LOADING_TEMPLATE"),G=new g("TRANSLOCO_SCOPE"),j=class{initialized=!1;resolve({inline:r,provider:e,active:t}){let i=t;if(this.initialized)return i=t,i;if(e){let[,s]=K(e,"static");i=s}if(r){let[,s]=K(r,"static");i=s}return this.initialized=!0,i}resolveLangBasedOnScope(r){return w(r)?L(r):r}resolveLangPath(r,e){return e?`${e}/${r}`:r}},F=class{service;constructor(r){this.service=r}resolve(r){let{inline:e,provider:t}=r;if(e)return e;if(t){if(Ae(t)){let{scope:i,alias:s=this.service.config.scopes.keepCasing?i:Se(i)}=t;return this.service._setScopeAlias(i,s),i}return t}}},bt=(()=>{class n{destroyRef=h(se);service=h($);tpl=h(x,{optional:!0});providerLang=h(Fe,{optional:!0});providerScope=h(G,{optional:!0});providedLoadingTpl=h(Qe,{optional:!0});cdr=h(N);host=h(re);vcr=h(le);renderer=h(oe);view;memo=new Map;key;params={};inlineScope;inlineRead;prefix;inlineLang;inlineTpl;currentLang;loaderTplHandler;initialized=!1;path;langResolver=new j;scopeResolver=new F(this.service);strategy=this.tpl===null?"attribute":"structural";static ngTemplateContextGuard(e,t){return!0}ngOnInit(){let e=Re(this.service,this.providerLang||this.inlineLang);if(this.service.langChanges$.pipe(y(t=>{let i=this.langResolver.resolve({inline:this.inlineLang,provider:this.providerLang,active:t});return Array.isArray(this.providerScope)?R(this.providerScope.map(s=>this.resolveScope(i,s))):this.resolveScope(i,this.providerScope)}),Ne(e),_(this.destroyRef)).subscribe(()=>{this.currentLang=this.langResolver.resolveLangBasedOnScope(this.path),this.strategy==="attribute"?this.attributeStrategy():this.structuralStrategy(this.currentLang,this.prefix||this.inlineRead),this.cdr.markForCheck(),this.initialized=!0}),!this.initialized){let t=this.resolveLoadingContent();t&&(this.loaderTplHandler=new z(t,this.vcr),this.loaderTplHandler.attachView())}}ngOnChanges(e){this.strategy==="attribute"&&Object.keys(e).some(i=>!e[i].firstChange)&&this.attributeStrategy()}attributeStrategy(){this.detachLoader(),this.renderer.setProperty(this.host.nativeElement,"innerText",this.service.translate(this.key,this.params,this.currentLang))}structuralStrategy(e,t){this.memo.clear();let i=this.getTranslateFn(e,t);this.view?(this.view.context.$implicit=i,this.view.context.currentLang=this.currentLang):(this.detachLoader(),this.view=this.vcr.createEmbeddedView(this.tpl,{$implicit:i,currentLang:this.currentLang}))}getTranslateFn(e,t){return(i,s)=>{let a=t?`${t}.${i}`:i,o=s?`${a}${JSON.stringify(s)}`:a;return this.memo.has(o)||this.memo.set(o,this.service.translate(a,s,e)),this.memo.get(o)}}resolveLoadingContent(){return this.inlineTpl||this.providedLoadingTpl}ngOnDestroy(){this.memo.clear()}detachLoader(){this.loaderTplHandler?.detachView()}resolveScope(e,t){let i=this.scopeResolver.resolve({inline:this.inlineScope,provider:t});this.path=this.langResolver.resolveLangPath(e,i);let s=B(t,i);return this.service._loadDependencies(this.path,s)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=ue({type:n,selectors:[["","transloco",""]],inputs:{key:[0,"transloco","key"],params:[0,"translocoParams","params"],inlineScope:[0,"translocoScope","inlineScope"],inlineRead:[0,"translocoRead","inlineRead"],prefix:[0,"translocoPrefix","prefix"],inlineLang:[0,"translocoLang","inlineLang"],inlineTpl:[0,"translocoLoadingTpl","inlineTpl"]},features:[ie]})}return n})(),St=(()=>{class n{service;providerScope;providerLang;cdr;subscription=null;lastValue="";lastKey;path;langResolver=new j;scopeResolver;constructor(e,t,i,s){this.service=e,this.providerScope=t,this.providerLang=i,this.cdr=s,this.scopeResolver=new F(this.service)}transform(e,t,i){if(!e)return e;let s=t?`${e}${JSON.stringify(t)}`:e;if(s===this.lastKey)return this.lastValue;this.lastKey=s,this.subscription?.unsubscribe();let a=Re(this.service,this.providerLang||i);return this.subscription=this.service.langChanges$.pipe(y(o=>{let c=this.langResolver.resolve({inline:i,provider:this.providerLang,active:o});return Array.isArray(this.providerScope)?R(this.providerScope.map(l=>this.resolveScope(c,l))):this.resolveScope(c,this.providerScope)}),Ne(a)).subscribe(()=>this.updateValue(e,t)),this.lastValue}ngOnDestroy(){this.subscription?.unsubscribe(),this.subscription=null}updateValue(e,t){let i=this.langResolver.resolveLangBasedOnScope(this.path);this.lastValue=this.service.translate(e,t,i),this.cdr.markForCheck()}resolveScope(e,t){let i=this.scopeResolver.resolve({inline:void 0,provider:t});this.path=this.langResolver.resolveLangPath(e,i);let s=B(t,i);return this.service._loadDependencies(this.path,s)}static \u0275fac=function(t){return new(t||n)(C($,16),C(G,24),C(Fe,24),C(N,16))};static \u0275pipe=de({name:"transloco",type:n,pure:!1})}return n})();function Ie(n){let r=[tt(ze),it(Ge),st(Je),nt(We)];return n.config&&r.push(Xe(n.config)),n.loader&&r.push(et(n.loader)),r}function Xe(n){return m([{provide:A,useValue:Ke(n)}])}function et(n){return m([{provide:ye,useClass:n}])}function At(...n){return n.map(r=>({provide:G,useValue:r,multi:!0}))}function tt(n){return m([{provide:Oe,useClass:n,deps:[A]}])}function nt(n){return m([{provide:Me,useClass:n,deps:[A]}])}function it(n){return m([{provide:Ce,useClass:n}])}function st(n){return m([{provide:we,useClass:n}])}var Ot=new g("TRANSLOCO_TEST_LANGS - Available testing languages"),Ct=new g("TRANSLOCO_TEST_OPTIONS - Testing options");var D=[{id:"en",label:"English"},{id:"fa",label:"\u0641\u0627\u0631\u0633\u06CC"}];var jt=(n,r="i18n")=>D.reduce((e,t)=>(e[t.id]=()=>n(t.id,r),e),{});var $e=(()=>{class n{constructor(){this._httpClient=h(Le)}getTranslation(e){return this._httpClient.get(`./assets/i18n/${e}.json`)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=p({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Kt=()=>[Ie({config:{availableLangs:D,prodMode:!ve()},loader:$e}),he(()=>(()=>{let r=h(pe).slice(0,2),e=h($);return e.setDefaultLang(r),e.setActiveLang(r),()=>Z(e.load(r))})()())];export{$ as a,bt as b,St as c,At as d,D as e,jt as f,Kt as g};
