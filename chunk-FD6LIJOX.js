import{b as we,c as Fe,d as Le,e as Re,f as $e,g as z,h as Be,i as ht,j as Ne,k as Oe,l as Ve,m as Pe,n as je,o as Ge,p as qe,q as He,r as Qe}from"./chunk-TEHKAY67.js";import{a as ze}from"./chunk-HSTAYPDS.js";import{c as Te}from"./chunk-AUAHNQGX.js";import{b as Ie,c as _t}from"./chunk-XETUAHZC.js";import{ca as le,ha as De}from"./chunk-KVJPCLDQ.js";import{a as ke,b as Ee,c as Me,h as be}from"./chunk-SIUYHYWA.js";import"./chunk-I3ROGWBB.js";import{c as Ae}from"./chunk-FMTLDRPV.js";import{a as ve}from"./chunk-NBWB5455.js";import{a as ue,b as V,c as fe,d as _e,f as he}from"./chunk-Q2JO2BZ4.js";import{b as ie,c as Y,d as X,e as ne}from"./chunk-KDKCNII2.js";import{a as T}from"./chunk-K3OUCCZ6.js";import{a as ge,b as at}from"./chunk-I234HARX.js";import{a as ut,b as Se,c as ye,d as ft}from"./chunk-BGJ7BR5O.js";import{A as pt,B as dt,a as oe,b as re,c as se,g as ce,h as et,j as ot,l as w,n as rt,o as st,p as xe,r as Mt,t as ct,u as lt,w as mt,z as Ce}from"./chunk-OHW5GPCH.js";import"./chunk-ZVCJ7HI5.js";import"./chunk-QEB7RJPV.js";import{k as nt}from"./chunk-OI4AFYXP.js";import"./chunk-GLXDHTOZ.js";import{V as Z,W as tt,Z as ae,da as N,ea as O,fa as me,ga as pe,ha as de,ia as it}from"./chunk-EGV4WSDU.js";import"./chunk-TCYW2OPJ.js";import{b as ee}from"./chunk-LUR2K6FW.js";import{k as Xt,n as J,p as Zt,q as K,s as te}from"./chunk-2BJKMOKI.js";import{Aa as H,B as Bt,Bc as C,Cb as _,Cc as A,D as Nt,Dc as Et,Ec as j,F as I,Fa as zt,Ga as Q,Gb as u,Ma as L,Mb as x,N as Ot,Nb as At,Ob as R,Pb as $,Pc as W,Qb as s,Rb as o,Sb as v,Sc as Kt,Tb as Ht,Ub as Qt,Vb as Ut,Wb as U,Wc as Yt,Z as Vt,aa as k,bc as B,da as Pt,dc as d,g as Ct,h as Ft,ib as n,ja as p,k as St,lc as Dt,m as Lt,mc as Wt,n as Rt,nc as M,oa as S,oc as c,pb as Gt,pc as m,qa as jt,qc as g,r as h,tb as qt,ub as yt,uc as kt,wc as y,x as $t,xc as Jt,yc as b,za as q}from"./chunk-3NJGGVEI.js";import{a as G,b as Tt,c as wt}from"./chunk-2R6CW7ES.js";var Ue=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=S({type:e,selectors:[["main-accounts"]],standalone:!0,features:[y],decls:1,vars:0,template:function(i,r){i&1&&v(0,"router-outlet")},dependencies:[Y],encapsulation:2,changeDetection:0})}}return e})();var vt="code",gt="asc",E=class{constructor(a){this.id=a.id,this.code=a.code,this.accountTypeId=a.accountTypeId,this.accountTypeName=a.accountTypeName,this.createDate=new Date(a.createDate),this.closeDate=a.closeDate?new Date(a.closeDate):void 0,this.balance=a.balance,this.persons=a.persons?.map(t=>new bt(t)),this.note=a.note,this.isActive=a.isActive}get fullName(){return this.accountTypeName+" "+this.persons.map(a=>a.name).join("/")}},bt=class{constructor(a){this.id=a.id,this.code=a.code,this.name=a.name}};var F=(()=>{class e{constructor(){this._appConfig=p(ve),this._httpClient=p(ee),this._pagination=new Ct(null),this._accounts=new Ct(null)}get pagination$(){return this._pagination.asObservable()}get _accounts$(){return this._accounts.asObservable()}getAccounts(t=1,i=10,r=`${vt} ${gt}`){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/account/all`,{params:{page:t,pageSize:i,sortBy:r}}).pipe(h(l=>({pagination:new Fe(l),items:l.items.map(f=>new E(f))})),k(l=>{this._pagination.next(l.pagination),this._accounts.next(l.items)}))}getLookupAccounts(){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/account/lookup`).pipe(h(t=>t))}getLookupAccountTypes(){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/accountType/lookup`).pipe(h(t=>t))}getAccount(t){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/account/${t}`).pipe(h(i=>new E(i)))}getBalanceAccount(t){return this._httpClient.get(`${this._appConfig.apiEndpoint}/api/account/${t}/balance`).pipe(h(i=>i))}getAccountWithBalance(t){return $t([this.getAccount(t),this.getBalanceAccount(t)]).pipe(h(i=>new E(G(G({},i[0]),i[1]))))}createAccount(t){return this._httpClient.post(`${this._appConfig.apiEndpoint}/api/account`,t).pipe(h(i=>new E(i)))}updateAccount(t){return this._httpClient.put(`${this._appConfig.apiEndpoint}/api/account`,t).pipe(h(i=>new E(i)),k(i=>{if(this._accounts.value){let r=this._accounts.value.findIndex(l=>l.id===i.id)??0;this._accounts.value[r]=i,this._accounts.next(this._accounts.value)}}))}closeAccount(t){return this._httpClient.post(`${this._appConfig.apiEndpoint}/api/account/close`,t).pipe(h(i=>new E(Tt(G({},i),{balance:0}))),k(i=>{if(this._accounts.value){let r=this._accounts.value.findIndex(l=>l.id===i.id)??0;this._accounts.value[r]=i,this._accounts.next(this._accounts.value)}}))}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=Pt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ze=e=>[e];function ti(e,a){if(e&1&&(Ht(0),s(1,"mat-icon",1),c(2),o(),Qt()),e&2){let t=a.$implicit,i=d();n(),u("ngClass",b(3,Ze,i.value()?"text-green-400":"text-red-400"))("matTooltip",i.value()?t("active"):t("inactive")),n(),g(" ",i.value()?"check_circle":"cancel"," ")}}var Je=(()=>{class e{constructor(){this.value=L(!0,{transform:Kt})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=S({type:e,selectors:[["main-accounts-status"]],inputs:{value:[1,"value"]},standalone:!0,features:[y],decls:1,vars:0,consts:[[4,"transloco"],[1,"text-green-400",3,"ngClass","matTooltip"]],template:function(i,r){i&1&&_(0,ti,3,5,"ng-container",0)},dependencies:[J,O,N,at,ge,V],styles:[`main-accounts-status{display:flex}
`],encapsulation:2,changeDetection:0})}}return e})();var ai=(e,a)=>a.id,oi=()=>["card","new"],ri=e=>({"mat-mdc-extended-fab-collapses":e}),si=e=>["card","view",e];function ci(e,a){if(e&1&&(s(0,"div",11)(1,"form",12)(2,"div",13)(3,"mat-icon"),c(4,"search"),o(),v(5,"input",14),o()()()),e&2){let t=a.$implicit,i=d();n(),u("formGroup",i.filterForm),n(4),u("placeholder",t("accounts.search"))}}function li(e,a){if(e&1&&(s(0,"div",20)(1,"div",21),c(2),o(),s(3,"div",22)(4,"span"),c(5),o()()()),e&2){let t=d().$implicit;n(2),g(" ",t.fullName," "),n(3),g("#",t.code,"")}}function mi(e,a){if(e&1&&(s(0,"div",4)(1,"div",15),v(2,"msk-avatar",16),o(),_(3,li,6,2,"div",17),s(4,"div",18),v(5,"main-accounts-status",19),o()()),e&2){let t=a.$implicit;u("routerLink",b(4,si,t.id)),n(2),u("name",t.persons[0].name),n(),u("translocoRead","accounts.details"),n(2),u("value",t.isActive)}}function pi(e,a){if(e&1&&(s(0,"div",5),c(1),o()),e&2){let t=a.$implicit;n(),g(" ",t("accounts.empty-list")," ")}}function di(e,a){e&1&&_(0,pi,2,1,"div",23)}function ui(e,a){if(e&1&&(s(0,"span"),c(1),o()),e&2){let t=a.$implicit;n(),m(t("new"))}}var xt=(()=>{class e{constructor(){this._destroyRef=p(Q),this._accountService=p(F),this._changeDetectorRef=p(W),this._gridContent=yt.required(nt),this._paginator=yt.required(z),this._sort=new Re,this.isLoading=!1,this.isFabCollapses=!1,this.lastOffsetScroll=0,this.pageSizeOptions=we,this.filterForm=new xe({search:new Mt(""),isActive:new Mt(null)})}ngOnInit(){this._accountService.pagination$.pipe(T(this._destroyRef),Nt(t=>!!t)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.accounts$=this._accountService._accounts$}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:vt,start:gt,disableClear:!0}),this._sort.sortChange.pipe(T(this._destroyRef),k(()=>this._paginator().pageIndex=0)).subscribe(),Bt(this._sort.sortChange,this._paginator().page).pipe(T(this._destroyRef),Vt(()=>this.getAccounts())).subscribe()),this._gridContent().elementScrolled().pipe(T(this._destroyRef),h(t=>t.target.scrollTop||0),k(t=>{let i=t>10?this.lastOffsetScroll<t:!1;this.isFabCollapses!==i&&(this.isFabCollapses=i,this._changeDetectorRef.markForCheck()),this.lastOffsetScroll=t})).subscribe()}getAccounts(t=!1){return this.isLoading=!0,this._changeDetectorRef.markForCheck(),this._accountService.getAccounts(t?1:this._paginator().pageIndex+1,this._paginator().pageSize,`${this._sort.active} ${this._sort.direction}`).pipe(I(i=>Lt()),Ot(()=>{this.isLoading=!1,this._changeDetectorRef.markForCheck()}))}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=S({type:e,selectors:[["main-accounts-list"]],viewQuery:function(i,r){i&1&&(Dt(r._gridContent,nt,5),Dt(r._paginator,z,5)),i&2&&Wt(2)},standalone:!0,features:[y],decls:16,vars:15,consts:[[1,"page-layout","grid-scroll"],["class","header",4,"transloco"],[1,"content"],["cdkScrollable","",1,"content-grid"],["matRipple","",1,"content-grid-item","tow-line",3,"routerLink"],[1,"text-secondary","p-8","text-center","text-xl","font-semibold","tracking-tight","sm:p-16"],[1,"content-fab-container"],["mat-fab","","extended","",3,"routerLink","ngClass"],[4,"transloco"],[1,"content-paginator",3,"length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","disabled"],[1,"pointer-events-none","invisible","absolute","h-0","w-0","opacity-0"],[1,"header"],[1,"flex","w-full","items-center",3,"formGroup"],[1,"msk-mat-search-bar","w-full"],["formControlName","search","autocomplete","off",3,"placeholder"],[1,"content-grid-item-avatar"],[3,"name"],["class","content-grid-item-content",4,"transloco","translocoRead"],[1,"content-grid-item-end"],[3,"value"],[1,"content-grid-item-content"],[1,"truncate"],[1,"flex","items-center","gap-2","truncate"],["class","text-secondary p-8 text-center text-xl font-semibold tracking-tight sm:p-16",4,"transloco"]],template:function(i,r){i&1&&(s(0,"div",0),_(1,ci,6,2,"div",1),s(2,"div",2)(3,"div",3),R(4,mi,6,6,"div",4,ai,!1,di,1,0,"div",5),C(7,"async"),o(),s(8,"div",6)(9,"button",7)(10,"mat-icon"),c(11,"add"),o(),_(12,ui,2,1,"span",8),o()(),v(13,"mat-paginator",9),o()(),s(14,"div",10),v(15,"router-outlet"),o()),i&2&&(n(4),$(A(7,10,r.accounts$)),n(5),u("routerLink",Jt(12,oi))("ngClass",b(13,ri,r.isFabCollapses))("@zoomIn",void 0),n(4),u("length",r.pagination.total)("pageIndex",r.pagination.pageIndex)("pageSize",r.pagination.pageSize)("pageSizeOptions",r.pageSizeOptions)("showFirstLastButtons",!0)("disabled",r.isLoading))},dependencies:[K,J,pt,ct,ot,rt,st,dt,lt,mt,ne,Y,nt,O,N,De,_t,tt,Z,it,pe,et,$e,Be,z,V,ht,Je],encapsulation:2,data:{animation:ft},changeDetection:0})}}return e})();var Ke=(()=>{class e{constructor(){this._renderer=p(Gt),this._matSelect=p(ut),this.searchList=L([]),this.searchItems=L.required(),this.searchPlaceholder=L("search ..."),this.filteredList=new Ft(1),Yt(()=>{this._list=this.searchList(),this.filteredList.next(this._list?this._list.slice():[])})}get showSearch(){return this._list&&this._list.length>5}onOpenedChange(t){if(!this.showSearch)return;if(!t){this.filteredList.next(this._list.slice());return}this._initMultipleHandling();let i=this._renderer.createElement("input");this._renderer.setAttribute(i,"placeholder",this.searchPlaceholder()),this._renderer.addClass(i,"mdc-text-field__input"),this._renderer.listen(i,"input",()=>{let f=i.value?i.value.toLowerCase():"";this.filteredList.next(this._list.filter(D=>this.searchItems()==null?this._includes(D,f):typeof this.searchItems()=="string"?this._includes(D[this.searchItems()],f):Array.isArray(this.searchItems())?this.searchItems().some(Xe=>this._includes(D[Xe],f)):!0)),setTimeout(()=>this._matSelect._keyManager.setFirstItemActive(),0)});let r=this._renderer.createElement("mat-option");this._renderer.setAttribute(r,"role","option"),this._renderer.addClass(r,"mat-mdc-option"),this._renderer.addClass(r,"mdc-list-item"),this._renderer.addClass(r,"z-999"),this._renderer.addClass(r,"top-0"),this._renderer.addClass(r,"sticky"),this._renderer.addClass(r,"border-b"),this._renderer.setStyle(r,"background","inherit"),this._renderer.appendChild(r,i);let l=document.querySelector(".mat-mdc-select-panel");if(!l)throw new Error("Cannot find mat select panel");this._renderer.setStyle(l,"padding-top","0"),this._renderer.insertBefore(l,r,l.firstChild),i.focus()}_includes(t,i){return t.toString().toLowerCase().includes(i)}_initMultipleHandling(){this._previousSelectedValues=this._matSelect.value,this._matSelect.valueChange?.subscribe(t=>{let i=!1,r=t&&Array.isArray(t)?[...t]:[];if(this._matSelect.multiple&&this._previousSelectedValues&&Array.isArray(this._previousSelectedValues)){(!t||!Array.isArray(t))&&(t=[]);let l=this._matSelect.options.map(f=>f.value);this._previousSelectedValues.forEach(f=>{!r.some(D=>this._matSelect.compareWith(D,f))&&!l.some(D=>this._matSelect.compareWith(D,f))&&(r.push(f),i=!0)})}this._previousSelectedValues=r,i&&this._matSelect._onChange(r)})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=jt({type:e,selectors:[["","mskSelectSearch",""]],hostBindings:function(i,r){i&1&&B("openedChange",function(f){return r.onOpenedChange(f)})},inputs:{searchList:[1,"searchList"],searchItems:[1,"searchItems"],searchPlaceholder:[1,"searchPlaceholder"]},exportAs:["mskSelectSearch"],standalone:!0})}}return e})();var fi=(e,a)=>a.id,_i=e=>({code:e}),hi=e=>({t:e});function vi(e,a){if(e&1){let t=U();s(0,"button",11),B("click",function(){q(t);let r=d(3);return H(r.editMode())}),s(1,"mat-icon",12),c(2,"edit"),o()()}}function gi(e,a){if(e&1&&_(0,vi,3,0,"button",10),e&2){let t=d(2);x(t.data.item!=null&&t.data.item.isActive?0:-1)}}function xi(e,a){if(e&1&&(s(0,"span"),c(1),o()),e&2){let t=a.$implicit,i=d(3);n(),m(i.form.enabled?t("save"):"")}}function Ci(e,a){if(e&1){let t=U();s(0,"button",13),B("click",function(){q(t);let r=d(2);return H(r.saveAndClose())}),_(1,xi,2,1,"span",14),o()}if(e&2){let t=d(2);u("disabled",t.form.disabled)("mskSpinner",t.form.disabled)}}function Si(e,a){if(e&1&&(s(0,"msk-dialog",8),Ut(1,9),_(2,gi,1,1,"ng-template",null,2,j)(4,Ci,2,2,"ng-template",null,3,j),o()),e&2){let t=a.$implicit,i=M(3),r=M(5),l=d(),f=M(2),D=M(4);u("title",t(l.data.action,b(6,_i,l.data.item==null?null:l.data.item.code)))("hasAction",l.data.action!=="view")("primaryAction",r)("trailing",i),n(),u("ngTemplateOutlet",l.data.action==="view"?f:D)("ngTemplateOutletContext",b(8,hi,t))}}function yi(e,a){if(e&1&&(s(0,"div",18)(1,"button",24)(2,"mat-icon",25),c(3,"arrow_upward"),o(),c(4),o(),s(5,"button",26)(6,"mat-icon",25),c(7,"arrow_downward"),o(),c(8),o(),s(9,"button",26)(10,"mat-icon",25),c(11,"swap_horiz"),o(),c(12),o()()),e&2){let t=a.$implicit;n(4),g(" ",t("deposit")," "),n(4),g(" ",t("withdraw")," "),n(4),g(" ",t("transfer")," ")}}function Ai(e,a){e&1&&_(0,yi,13,3,"div",23)}function Di(e,a){if(e&1&&(s(0,"div",21)(1,"div",27),v(2,"msk-avatar",28),o(),s(3,"div",29)(4,"span"),c(5),o(),s(6,"span"),c(7),o()(),s(8,"div",27)(9,"mat-icon",30),c(10,"open_in_new"),o()()()),e&2){let t=a.$implicit;n(2),u("name",t.name),n(3),m(t.name),n(2),g("#",t.code,"")}}function ki(e,a){if(e&1&&(s(0,"div",22)(1,"div",27)(2,"mat-icon"),c(3,"credit_card_gear"),o()(),s(4,"div",29)(5,"span"),c(6),o(),s(7,"span"),c(8),o()()()),e&2){let t=d().t,i=d();n(6),m(i.data.item==null?null:i.data.item.accountTypeName),n(2),m(t("accountType"))}}function Ei(e,a){if(e&1&&(s(0,"div",22)(1,"div",27)(2,"mat-icon"),c(3,"calendar_add_on"),o()(),s(4,"div",29)(5,"span"),c(6),C(7,"mskDateTime"),o(),s(8,"span"),c(9),o()()()),e&2){let t=d().t,i=d();n(6),m(Et(7,2,i.data.item==null?null:i.data.item.createDate,"longDate")||"-"),n(3),m(t("createDate"))}}function Mi(e,a){if(e&1&&(s(0,"div",22)(1,"div",27)(2,"mat-icon"),c(3,"event_busy"),o()(),s(4,"div",29)(5,"span"),c(6),C(7,"mskDateTime"),o(),s(8,"span"),c(9),o()()()),e&2){let t=d().t,i=d();n(6),m(Et(7,2,i.data.item==null?null:i.data.item.closeDate,"longDate")||"-"),n(3),m(t("closeDate"))}}function bi(e,a){if(e&1&&(s(0,"div",19)(1,"div",20),c(2),o(),s(3,"div",22)(4,"div",27)(5,"mat-icon"),c(6,"sticky_note_2"),o()(),s(7,"div",29)(8,"span"),c(9),o()()()()),e&2){let t=d().t,i=d();n(2),m(t("note")),n(7),m(i.data.item==null?null:i.data.item.note)}}function Ii(e,a){if(e&1){let t=U();s(0,"div",33)(1,"div",20),c(2),o(),s(3,"div",34),B("click",function(){q(t);let r=d(3);return H(r.updateStatus())}),s(4,"div",27)(5,"mat-icon",35),c(6," cancel "),o()(),s(7,"div",29)(8,"span",35),c(9),o()()()()}if(e&2){let t=a.$implicit;n(2),m(t("settings")),n(7),g(" ",t("accounts.deactivate")," ")}}function Ti(e,a){e&1&&(v(0,"div",31),_(1,Ii,10,2,"div",32))}function wi(e,a){if(e&1&&(s(0,"div",15)(1,"span",16),c(2),o(),s(3,"span",17),c(4),C(5,"currency"),o()(),_(6,Ai,1,0,"div",18),s(7,"div",19)(8,"div",20),c(9),o(),R(10,Di,11,3,"div",21,fi),o(),s(12,"div",19)(13,"div",20),c(14),o(),_(15,ki,9,2,"div",22)(16,Ei,10,5,"div",22)(17,Mi,10,5,"div",22),o(),_(18,bi,10,2,"div",19)(19,Ti,2,0)),e&2){let t=a.t,i=d();n(2),m(t("credit")),n(2),m(A(5,10,i.data.item==null?null:i.data.item.balance)),n(2),x(i.data.item!=null&&i.data.item.isActive?6:-1),n(3),m(t("owners")),n(),$(i.data.item==null?null:i.data.item.persons),n(4),m(t("about")),n(),x(i.data.item!=null&&i.data.item.accountTypeName?15:-1),n(),x(i.data.item!=null&&i.data.item.createDate?16:-1),n(),x(i.data.item!=null&&i.data.item.closeDate?17:-1),n(),x(i.data.item!=null&&i.data.item.note?18:-1),n(),x(i.data.item!=null&&i.data.item.isActive?19:-1)}}function Fi(e,a){if(e&1&&(s(0,"msk-alert",37)(1,"span",44),c(2),o(),c(3),o()),e&2){let t=a.$implicit;n(2),m(t("info-edit-title")),n(),g(" ",t("info-edit-description")," ")}}function Li(e,a){e&1&&_(0,Fi,4,2,"msk-alert",43),e&2&&u("translocoRead","accounts")}function Ri(e,a){if(e&1&&(s(0,"msk-alert",38),c(1),o()),e&2){let t=d(2);u("@shake",void 0),n(),g(" ",t.alert().message," ")}}function $i(e,a){if(e&1&&(s(0,"mat-option",41),c(1),o()),e&2){let t=a.$implicit;u("value",t.id),n(),m(t.name)}}function Bi(e,a){if(e&1&&(s(0,"div",39)(1,"mat-form-field")(2,"mat-label"),c(3),o(),kt(4),C(5,"async"),s(6,"mat-select",45,5),C(8,"transloco"),R(9,$i,2,2,"mat-option",41,At),C(11,"async"),o(),s(12,"mat-error"),c(13),o()(),s(14,"mat-form-field")(15,"mat-label"),c(16),o(),v(17,"input",46)(18,"mat-datepicker-toggle",47)(19,"mat-datepicker",null,6),s(21,"mat-error"),c(22),o()()()),e&2){let t=M(7),i=M(20),r=d().t,l=d();n(3),m(r("accountType"));let f=A(5,9,l.accountTypeList$);n(3),u("searchList",f)("searchItems","name")("searchPlaceholder",A(8,11,"search")),n(3),$(A(11,13,t.filteredList)),n(4),m(l.formErrors.accountTypeId),n(3),m(r("createDate")),n(),u("matDatepicker",i),n(),u("for",i),n(4),m(l.formErrors.createDate)}}function Ni(e,a){if(e&1&&(s(0,"mat-option",41),c(1),o()),e&2){let t=a.$implicit;u("value",t.id),n(),m(t.name)}}function Oi(e,a){if(e&1&&(s(0,"mat-form-field")(1,"mat-label"),c(2),o(),v(3,"input",48),s(4,"mat-error"),c(5),o()()),e&2){let t=d().t,i=d();n(2),m(t("initCredit")),n(3),m(i.formErrors.initCredit)}}function Vi(e,a){if(e&1&&(s(0,"form",36),_(1,Li,1,1,"msk-alert",37)(2,Ri,2,2,"msk-alert",38)(3,Bi,23,15,"div",39),s(4,"mat-form-field")(5,"mat-label"),c(6),o(),kt(7),C(8,"async"),s(9,"mat-select",40,4),C(11,"transloco"),s(12,"mat-select-trigger"),c(13),o(),R(14,Ni,2,2,"mat-option",41,At),C(16,"async"),o(),s(17,"mat-error"),c(18),o()(),_(19,Oi,6,2,"mat-form-field"),s(20,"mat-form-field"),v(21,"textarea",42),s(22,"mat-error"),c(23),o()()()),e&2){let t=a.t,i=M(10),r=d();u("formGroup",r.form),n(),x(r.data.action==="edit"?1:-1),n(),x(r.alert().show?2:-1),n(),x(r.data.action==="new"?3:-1),n(3),m(t("owners"));let l=A(8,14,r.personList$);n(3),u("searchList",l)("searchItems","name")("searchPlaceholder",A(11,16,"search")),n(4),m(r.personIdTitles(l)),n(),$(A(16,18,i.filteredList)),n(4),m(r.formErrors.personId),n(),x(r.data.action==="new"?19:-1),n(2),u("placeholder",t("note"))("rows",2),n(2),m(r.formErrors.note)}}var Ye=(()=>{class e{constructor(){this.data=p(Ee),this.dialogRef=p(ke),this._formBuilder=p(Ce),this._peopleService=p(Le),this._accountService=p(F),this._translocoService=p(ue),this._changeDetectorRef=p(W),this._mskConfirmationService=p(ze),this.formErrors={},this.personList$=this._peopleService.getLookupPersons(),this.accountTypeList$=this._accountService.getLookupAccountTypes(),this.alert=qt({show:!1,message:""})}ngOnInit(){this.form=this._formBuilder.group({id:[0,w.required],personId:[[],w.required],accountTypeId:["",w.required],initCredit:["",[w.required,w.min(1e3)]],createDate:[new Date(new Date().setHours(0,0,0,0)),w.required],note:""}),new qe(this.form,this.formErrors,this._translocoService),this.form.patchValue(this.data.item||{}),this.form.get("personId")?.patchValue(this.data.item?.persons.map(t=>t.id)||[])}personIdTitles(t){let i=this.form.get("personId")?.value;return t?.find(l=>l.id===i[0])?.name+(i.length>1?` (+${i.length-1} ${this._translocoService.translate("other")})`:"")}editMode(){this.data.action="edit",this.form.get("initCredit")?.clearValidators()}updateStatus(){let t=this.data.item?.isActive;this._mskConfirmationService.open({title:this._translocoService.translate(t?"accounts.deactivate":"accounts.activate"),message:this._translocoService.translate(t?"accounts.deactivate-message":"accounts.activate-message",{name:this.data.item?.fullName}),actions:{confirm:{label:this._translocoService.translate(t?"close":"open")},cancel:{label:this._translocoService.translate("cancel")}}}).afterClosed().subscribe(r=>{if(r!=="confirmed")return;let l={id:this.data.item?.id,closeDate:new Date(new Date().setSeconds(0,0))};this._accountService.closeAccount(l).pipe(h(f=>{this.data.item=f,this._changeDetectorRef.markForCheck()}),I(f=>St)).subscribe()})}saveAndClose(){if(Qe(this.form),this.form.invalid)return;this.form.disable(),this.alert.set({show:!1,message:""}),(this.data.action==="edit"?this._accountService.updateAccount({id:this.form.value.id,personId:this.form.value.personId,note:this.form.value.note}):this._accountService.createAccount(this.form.value)).pipe(k(i=>this.dialogRef.close(i)),I(i=>(this.form.enable(),this.alert.set({show:!0,message:i.error.message}),He(i.error.errors,this.form),St))).subscribe()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=S({type:e,selectors:[["main-people-details"]],standalone:!0,features:[y],decls:5,vars:1,consts:[["viewTemplate",""],["formTemplate",""],["trailing",""],["primaryAction",""],["searchPersons","mskSelectSearch"],["searchAccountTypes","mskSelectSearch"],["picker",""],[3,"title","hasAction","primaryAction","trailing",4,"transloco","translocoRead"],[3,"title","hasAction","primaryAction","trailing"],["msk-dialog-content","",3,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-icon-button",""],["mat-icon-button","",3,"click"],[1,"mat-icon-rtl-mirror","text-current"],["mat-button","",3,"click","disabled","mskSpinner"],[4,"transloco"],[1,"flex","flex-col","gap-4","p-4"],[1,"text-on-surface-variant","text-label-medium"],[1,"text-on-surface","text-title-large"],[1,"grid","grid-cols-3","gap-4","py-4"],[1,"msk-mat-card-filled","mb-2","p-4"],[1,"text-secondary","mb-2","font-bold"],["matRipple","",1,"msk-list-item","-mx-4","cursor-pointer"],[1,"msk-list-item","-mx-4"],["class","grid grid-cols-3 gap-4 py-4",4,"transloco"],["mat-flat-button",""],[1,"hidden","sm:block"],["mat-stroked-button",""],[1,"msk-list-item-icon"],[3,"name"],[1,"msk-list-item-content"],[1,"mat-icon-rtl-mirror"],[1,"my-4","border-t"],["class","mb-2",4,"transloco"],[1,"mb-2"],["matRipple","",1,"msk-list-item","-mx-6","cursor-pointer","gap-2",3,"click"],[1,"!text-error"],[1,"flex","flex-auto","flex-col","gap-y-2",3,"formGroup"],["appearance","outline","type","info","dismissible","",1,"mb-4"],["appearance","outline","type","error",1,"mb-4"],[1,"flex","flex-col","gap-x-4","sm:flex-row","[&>*]:flex-1"],["formControlName","personId","multiple","","mskSelectSearch","",3,"searchList","searchItems","searchPlaceholder"],[3,"value"],["matInput","","formControlName","note",3,"placeholder","rows"],["class","mb-4","appearance","outline","type","info","dismissible","",4,"transloco","translocoRead"],["mskAlertTitle",""],["formControlName","accountTypeId","mskSelectSearch","",3,"searchList","searchItems","searchPlaceholder"],["matInput","","formControlName","createDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["matInput","","formControlName","initCredit","autocomplete","off"]],template:function(i,r){i&1&&_(0,Si,6,10,"msk-dialog",7)(1,wi,20,12,"ng-template",null,0,j)(3,Vi,24,20,"ng-template",null,1,j),i&2&&u("translocoRead","accounts.details")},dependencies:[Zt,K,te,pt,ct,ot,rt,st,dt,lt,mt,O,N,_t,Ie,ce,oe,re,se,tt,Z,it,me,de,ye,ut,Se,ae,at,et,Pe,Ne,Oe,Ve,be,fe,V,Ae,ht,je,Te,Ke,Ge],encapsulation:2,data:{animation:ft},changeDetection:0})}}return e})();var It=(()=>{class e{constructor(){this._router=p(X),this._injector=p(zt),this._matDialog=p(Me),this._destroyRef=p(Q),this._activatedRoute=p(ie),this._mskLayoutConfigService=p(le)}ngOnInit(){let t=this._activatedRoute.snapshot.url[1].path;this._mskLayoutConfigService.config$.pipe(T(this._destroyRef),h(i=>this.layoutDirection=Xt(i.locale))).subscribe(),this._matDialog.open(Ye,{autoFocus:t!=="view",disableClose:t!=="view",direction:this.layoutDirection,data:{action:t,item:this._activatedRoute.snapshot.data.card}}).afterClosed().subscribe(i=>{t==="new"&&i!="cancelled"&&this._injector.get(xt).getAccounts().subscribe(),this._router.navigate([this._activatedRoute.snapshot.url.map(()=>"../").join("")],{relativeTo:this._activatedRoute})})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=S({type:e,selectors:[["main-accounts-card"]],standalone:!0,features:[y],decls:0,vars:0,template:function(i,r){},encapsulation:2,changeDetection:0})}}return e})();var Pi=wt({"./i18n/en.json":()=>import("./chunk-V4WTMKZN.js"),"./i18n/fa.json":()=>import("./chunk-HTZE5BF4.js")});var ji=(e,a)=>{let t=p(F),i=p(X);return t.getAccountWithBalance(e.paramMap.get("id")??0).pipe(I(r=>{console.error(r);let l=a.url.split("/").slice(0,-1).join("/");return i.navigateByUrl(l),Rt(()=>new Error(r.message))}))},Ja=[{path:"",component:Ue,providers:[_e({scope:"accounts",loader:he((e,a)=>Pi(`./${a}/${e}.json`))})],children:[{path:"",component:xt,resolve:{persons:()=>p(F).getAccounts()},children:[{path:"card/new",component:It,resolve:{}},{path:"card/view/:id",component:It,resolve:{card:ji}}]}]}];export{Ue as AccountsComponent,Ja as routes};
