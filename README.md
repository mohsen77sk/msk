# Msk

<a alt="Nx logo" href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, Smart Monorepos · Fast CI.](https://nx.dev)** ✨

---

## Demo

- GitHub Pages: https://mohsen77sk.github.io/msk/

---

## Overview

An Nx monorepo containing multiple Angular 20 applications and shared/domain libraries. Each app composes features from domain-specific libs (e.g., `mirza`, `onco`, `sahebzaman`) and common building blocks from `shared`.

- Framework: Angular 20, Nx 21
- UI: Angular Material, Tailwind CSS 4
- i18n: Transloco
- Utilities: RxJS, date-fns (+ Jalali), lodash
- Tooling: Jest (unit test), ESLint, Prettier
- PWA: Service Worker configured for some apps (see below)

---

## Prerequisites

- Node.js 18+ (LTS recommended) and npm
- Recommended: a modern terminal with `npx`

Install dependencies:

```bash
npm ci
```

---

## Running locally

Each app has its own dev server and port.

```bash
# Docs site
npx nx serve docs          # http://localhost:5100

# Sahebzaman app
npx nx serve sahebzaman    # http://localhost:5200

# Mirza (write)
npx nx serve mirza-write   # http://localhost:5300

# Onco app
npx nx serve onco          # http://localhost:5400
```

Notes:
- Default configuration is "development" (with source maps and no optimization).
- Use `--configuration=production` to serve a production build via the static file server target (see below) or build first and serve statically.

---

## Building

You can build via project-specific scripts or generic Nx commands.

```bash
# Project-specific (from package.json)
npm run build-docs
npm run build-sahebzaman
npm run build-mirza
npm run build-onco

# Generic Nx form
npx nx build docs --configuration=production
npx nx build sahebzaman --configuration=production
npx nx build mirza-write --configuration=production
npx nx build onco --configuration=production
```

- Output paths:
  - `dist/apps/docs` → `dist/apps/docs/browser`
  - `dist/apps/sahebzaman` → `dist/apps/sahebzaman/browser`
  - `dist/apps/mirza-write` → `dist/apps/mirza-write/browser`
  - `dist/apps/onco` → `dist/apps/onco/browser`
- The `docs` build is configured with `--base-href=/msk/` (suitable for GitHub Pages).

Serve a built app statically:

```bash
# After building
npx nx serve-static docs
npx nx serve-static sahebzaman
npx nx serve-static mirza-write
npx nx serve-static onco
```

---

## Testing & Linting

```bash
# Lint all projects
npm run lint
# or
npx nx run-many --target=lint --all

# Test a single project
npx nx test <project-name>

# Test multiple/all
npx nx run-many --target=test --all
```

---

## Environment configuration

Each app has `src/environments/environment.ts` (production defaults) and `environment.development.ts` (used by the dev configuration). The common shape:

```ts
export const environment = {
  production: false,
  apiEndpoint: 'https://…'
};
```

- Mirza (write): `apps/mirza-write/src/environments/`
  - `apiEndpoint`: `https://dev.api.cafemirza.ir`
- Sahebzaman: `apps/sahebzaman/src/environments/`
  - `apiEndpoint`: `https://api.s-sahebzaman.ir`
- Onco: `apps/onco/src/environments/`
  - `apiEndpoint`: `https://api.onco.cafemirza.ir`

---

## PWA / Service Worker

- Enabled in production for:
  - `mirza-write` (`apps/mirza-write/ngsw-config.json`)
  - `sahebzaman` (`apps/sahebzaman/ngsw-config.json`)
  - `onco` (`apps/onco/ngsw-config.json`)
- Not enabled for `docs`.

---

## Project structure

```text
.
└── root
    ├── apps
    │    ├── docs (angular)
    │    ├── mirza-write (angular)
    │    └── sahebzaman (angular)
    └── libs
        ├── docs (dir)
        │    ├── assets (dir)
        │    ├── shell (dir)
        │    │    ├── core (dir)
        │    │    ├── feature (angular:lib) - for configure any forRoot modules
        │    │    └── ui (dir)
        │    │        └── layout (angular:lib)
        │    └── panel (dir)
        │         ├── colors (dir)
        │         ├── typography (dir)
        │         └── ...
        ├── mirza (dir)
        │    ├── assets (dir)
        │    ├── shell (dir)
        │    │    ├── core (dir)
        │    │    ├── feature (angular:lib) - for configure any forRoot modules
        │    │    └── ui (dir)
        │    │        └── layout (angular:lib)
        │    ├── auth (dir)
        │    │    ├── sign-in (angular:lib)
        │    │    └── sign-out (angular:lib)
        │    └── panel (dir)
        │         ├── dashboard (angular:lib)
        │         └── ...
        ├── onco (dir)
        │    ├── assets (dir)
        │    ├── shell (dir)
        │    │    ├── core (dir)
        │    │    ├── feature (angular:lib) - for configure any forRoot modules
        │    │    └── ui (dir)
        │    │        └── layout (angular:lib)
        │    ├── auth (dir)
        │    │    ├── sign-in (angular:lib)
        │    │    └── sign-out (angular:lib)
        │    └── panel (dir)
        │         ├── dashboard (angular:lib)
        │         └── ...
        ├── sahebzaman (dir)
        │    ├── assets (dir)
        │    ├── shell (dir)
        │    │    ├── core (dir)
        │    │    ├── feature (angular:lib) - for configure any forRoot modules
        │    │    └── ui (dir)
        │    │        └── layout (angular:lib)
        │    ├── auth (dir)
        │    │    ├── sign-in (angular:lib)
        │    │    └── sign-out (angular:lib)
        │    └── panel (dir)
        │         ├── dashboard (angular:lib)
        │         └── ...
        └── shared (dir)
            ├── animations (angular:lib animations)
            ├── data-access (angular:lib, API call, Service or State management to share across the Client app)
            ├── assets (dir)
            ├── styles (dir)
            ├── pages (optional dir, if I have multiple client apps)
            ├── ui (optional dir, if I have multiple client apps)
            ├── pipes (optional dir, if I have multiple client apps)
            ├── services (optional dir, if I have multiple client apps)
            ├── directives (optional dir, if I have multiple client apps)
            ├── validators (optional dir, if I have multiple client apps)
            └── utils (optional dir, if I have multiple client apps)
```

### Apps & Ports

- `docs`: 5100
- `sahebzaman`: 5200
- `mirza-write`: 5300
- `onco`: 5400

---

## Styling & Theming

- Tailwind CSS v4 via PostCSS (`@tailwindcss/postcss`) is wired in.
- Global/shared styles live under `libs/shared/styles`.
- Angular Material is available across apps; per-domain themes are defined (e.g., `libs/*/styles/src/themes.scss`).

---

## Useful Nx commands

```bash
# Visualize project graph
npx nx graph

# Run a target for many projects
npx nx run-many --target=build --all

# Affected commands (CI-friendly)
npx nx affected --target=build --base=master
```

---

## Deployment

- `docs` is configured for GitHub Pages (`--base-href=/msk/`). After `npm run build-docs`, deploy `dist/apps/docs/browser` as static files.
- Other apps produce static builds in `dist/apps/<app>/browser` that can be hosted on any static web server or CDN.

---

## License

MIT
